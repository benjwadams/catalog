{% extends "layout.html" %}

{% block jumbo %}
<div class="row">
    <div class="col-lg-3">
        <h3> <a href="{{ url_for('datasets') }}">Datasets</a><br/><small><a href="/">IOOS Catalog</a></small></h3>
    </div>
    <form class="form-inline">
        <div class="col-lg-3">
            <label for="filter-type">By Type</label>
            <select name="filter-type" class="form-control">
                <option value="null">-</option>
                {%- for a in assettypes|sort %}
                <option>{{ a }}</option>
                {%- endfor %}
            </select>
        </div>
    </form>
</div>
{% endblock %}

{% block page %}

<div class="container">
    <table class="table table-striped table-bordered table-condensed" style="font-size: 11px;">
        <thead>
            <tr>
                <th>uid</th>
                <th>updated (utc)</th>
            </tr>
        </thead>
        <tbody>
        {%- for d in datasets %}
            <tr>
                <td><a href="{{ url_for('show_dataset', dataset_id=d._id) }}">{{ d.uid }}</a></td>
                <td>{{ d.updated | datetimeformat }}</td>
            </tr>
        {%- endfor %}
         </tbody>
    </table>

    <script type="text/javascript">
      $(function() {

        {% if 'asset_type' in filters %}
          $('select[name="filter-type"]').val('{{ filters['asset_type'] }}');
        {% endif %}

        $('select[name^="filter"]').change(function() {
          var typeVal = $('select[name="filter-type"]').val();
          if (typeVal == "null") {
            window.location = "{{ url_for("datasets") }}";
            return;
          }
          var url = '{{ url_for("datasets") }}filter/';
          url += typeVal;
          window.location = url;
        });
      });
    </script>

</div>

{% endblock %}
