{% extends "layout.html" %}

{% block jumbo %}
<div class="row">
  <div class="col-lg-6">
    <h3> <a href="{{ url_for('metadatas') }}">Metadata</a><br/><small><a href="/">IOOS Catalog</a></small></h3>
  </div>
  <form class="form-inline">
    <div class="col-lg-3">
      <label for="filter-provider">By Provider</label>
      <select name="filter-provider" class="form-control">
        <option value="null">-</option>
      </select>
    </div>
    <div class="col-lg-3">
      <label for="filter-type">By Type</label>
      <select name="filter-type" class="form-control">
        <option value="null">-</option>
      </select>
    </div>
  </form>
</div>
{% endblock %}

{% block page %}

  <table class="table table-striped table-bordered table-condensed" style="font-size: 11px;">
    <thead>
      <tr>
        <th>Serv/DS</th>
        <th>Provider</th>
        <th>Type</th>
        {%- for col in columns %}
        <th>{{ col }}</th>
        {%- endfor %}
      </tr>
    </thead>
    <tbody>
    {%- for m in metadatas %}
      <tr>
        <td>{{ services[m['ref_id']].name if m['ref_type']=='service' }}</td>
        <td>{{ services[m['ref_id']].data_provider if m['ref_type']=='service' }}</td>
        <td>{{ m['ref_type'] }} / {{ m['ref_subtype'] }}</td>

        {%- for col in columns %}
        <td>
          {%- set v=m['metamap'].get(col, "-") %}
          {%- if v|is_list %}
            <ul class="list-unstyled">
              {%- for vv in v %}
              <li>{{ vv }}</li>
              {%- endfor %}
            </ul>
          {% else %}
            {{ v }}
          {% endif %}
        </td>
        {%- endfor %}

      </tr>
    {%- endfor %}
    </tbody>
  </table>

{% endblock %}
